////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// File: "debugControl.h"
// Author: Scott Smallback (SS)
// Purpose: This will draw all the collision rects around the objects
// 
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


#pragma once

#include <vector>
#include "../helpers/datatypes.h"
#include "../eventsystem/listener.h"

class objManager;
class viewManager;
class renderer;
class CTileEngine;
class bitFont;

class debugControl : public listener
{
protected:
	objManager* OM;
	viewManager* VM;
	CTileEngine* TE;
	renderer* Re;
	bitFont* font;

	char calcString[154];
	//char rendString[154];
	float time;
	int updCount;
	int rendCount;

	volatile bool ready;
	volatile bool locked;

	volatile int uCount;
	volatile int rCount;

	rect dot;

	//I was going to do something more...but yeah.
	struct drawGroup
	{
		std::vector<vector3> pts;

		drawGroup() {}
	};

	std::vector<drawGroup> lineGroups;
	std::vector<drawGroup> mapLines;
	std::vector<drawGroup> magLines;
	std::vector<vector3> posPts;

	void getMapCollisions();

public:
	debugControl();
	~debugControl();

	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//	Function:		"initialize"
	//	Last Modified:	September 22, 2008
	//	Purpose:		initializes the collision rects
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	void initialize();
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//	Function:		"shutdown"
	//	Last Modified:	September 22, 2008
	//	Purpose:		Shuts down and fixes memory leaks
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	void shutdown();

	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//	Function:		"update"
	//	Last Modified:	September 22, 2008
	//	Purpose:		updates all collision rects
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	void update(float dt);
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	//	Function:		"render"
	//	Last Modified:	September 22, 2008
	//	Purpose:		renders the rects
	//////////////////////////////////////////////////////////////////////////////////////////////////////
	void render();

	void HandleEvent(gameEvent* ev);
};